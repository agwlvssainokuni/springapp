apply plugin: "eclipse-wtp"

dependencies {
	compile "javax.servlet:javax.servlet-api:3.0.1"
	compile "javax.servlet.jsp:javax.servlet.jsp-api:2.2.1"
}

configurations {
	antTask
}

dependencies {
	antTask "com.h2database:h2:1.3.175"
	antTask "org.mybatis.generator:mybatis-generator-core:1.3.2"
}

buildscript {
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath "com.googlecode.flyway:flyway-gradle-plugin:2.3"
	}
}

apply plugin: 'flyway'

flyway {
	driver = "org.h2.Driver"
	url = "jdbc:h2:common/build/mbgenerator"
	user = "sa"
	encoding = "UTF-8"
}

task mbgenerator << {
	ant {
		taskdef(name: "mbgenerator",
			classname: "org.mybatis.generator.ant.GeneratorAntTask",
			classpath: configurations.antTask.asPath)
		mbgenerator(configfile: "common/mbgenerator.xml", overwrite: true, verbose: true)
	}
}
mbgenerator.dependsOn flywayMigrate
